# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è Socket.IO –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

## üîß –ü—Ä–æ–±–ª–µ–º–∞

–û—à–∏–±–∫–∞ "Invalid namespace" –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ Socket.IO —Å–µ—Ä–≤–µ—Ä—É - –∫–ª–∏–µ–Ω—Ç –ø—ã—Ç–∞–ª—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –∫–æ—Ä–Ω–µ–≤–æ–º—É namespace, –∞ —Å–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ `/api/calc`.

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. SocketService.ts

- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω namespace**: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ `/api/calc` –≤–º–µ—Å—Ç–æ –∫–æ—Ä–Ω–µ–≤–æ–≥–æ
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**: –ü–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ –≤ `extraHeaders` –≤–º–µ—Å—Ç–æ `auth`

```typescript
// –ë—ã–ª–æ:
this.socket = io('http://localhost:8001', { auth: { token: `Bearer ${token}` } });

// –°—Ç–∞–ª–æ:
this.socket = io('http://localhost:8001/api/calc', {
  extraHeaders: { Authorization: `Bearer ${token}` },
});
```

### 2. Socket API —Ñ—É–Ω–∫—Ü–∏–∏

- **–£–ø—Ä–æ—â–µ–Ω —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö**: –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ `{ observations: [...] }`
- **–£–±—Ä–∞–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏–∑ payload**: –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ headers –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- **–£–±—Ä–∞–Ω requestId**: –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è API

```typescript
// –ë—ã–ª–æ:
socket.emit('calculate', {
  observations: [...],
  requestId: '123',
  authorization: 'Bearer ...'
});

// –°—Ç–∞–ª–æ:
socket.emit('calculate', { observations: [...] });
```

### 3. –ù–æ–≤—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

- **–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä** (`/calculator`): –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å —Ñ–æ—Ä–º–æ–π –¥–ª—è —Ä–∞—Å—á–µ—Ç–æ–≤
- **–ù–∞–≤–∏–≥–∞—Ü–∏—è**: –î–æ–±–∞–≤–ª–µ–Ω—ã —Å—Å—ã–ª–∫–∏ "–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä" –∏ "–ò—Å—Ç–æ—Ä–∏—è" –≤ Header

## üöÄ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–±—ã—Ç–∏–π Socket.IO

### –û—Ç–ø—Ä–∞–≤–ª—è–µ–º—ã–µ —Å–æ–±—ã—Ç–∏—è:

- `calculate` - –ó–∞–ø—É—Å–∫ —Ä–∞—Å—á–µ—Ç–∞ –æ—Ä–±–∏—Ç—ã
- `getHistory` - –ü–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ —Ä–∞—Å—á–µ—Ç–æ–≤
- `getStatus` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–¥–∞—á–∏

### –ü–æ–ª—É—á–∞–µ–º—ã–µ —Å–æ–±—ã—Ç–∏—è:

- `result` - –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞—Å—á–µ—Ç–∞
- `status` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ (queued ‚Üí processing ‚Üí completed)
- `error` - –û—à–∏–±–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- `historyList` - –°–ø–∏—Å–æ–∫ –∏—Å—Ç–æ—Ä–∏–∏

## üìä –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

1. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ `/calculator`
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –º–∏–Ω–∏–º—É–º 3 –Ω–∞–±–ª—é–¥–µ–Ω–∏—è
4. –ù–∞–∂–º–∏—Ç–µ "–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –æ—Ä–±–∏—Ç—É"
5. –ù–∞–±–ª—é–¥–∞–π—Ç–µ real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞

## üîó –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

–ö–æ–¥ —Å–æ–≤–º–µ—Å—Ç–∏–º —Å —Ñ–æ—Ä–º–∞—Ç–æ–º –¥–∞–Ω–Ω—ã—Ö, –ø–æ–∫–∞–∑–∞–Ω–Ω—ã–º –≤ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞—Ö:

- Namespace: `/calc`
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è: `Bearer token` –≤ Headers
- –§–æ—Ä–º–∞—Ç –Ω–∞–±–ª—é–¥–µ–Ω–∏–π: `{ra_hours, dec_degrees, timestamp}`
- –°–æ–±—ã—Ç–∏—è: `result`, `status`, `error` –∫–∞–∫ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
